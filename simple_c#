Function GetCombinations(list() As String) As Variant
    Dim n As Integer
    n = UBound(list) + 1
    
    If n = 0 Then
        GetCombinations = Array(Array())
    ElseIf n = 1 Then
        GetCombinations = Array(list)
    Else
        Dim head As String
        head = list(0)
        
        Dim tail() As String
        ReDim tail(n - 2)
        Dim i As Integer
        For i = 1 To n - 1
            tail(i - 1) = list(i)
        Next i
        
        Dim subcombinations As Variant
        subcombinations = GetCombinations(tail)
        
        Dim num_subcombinations As Integer
        num_subcombinations = UBound(subcombinations) + 1
        
        Dim combinations() As Variant
        ReDim combinations(num_subcombinations - 1)
        Dim j As Integer
        For j = 0 To num_subcombinations - 1
            Dim subcombination() As String
            subcombination = subcombinations(j)
            
            Dim k As Integer
            ReDim combination(n - 1)
            combination(0) = head
            For k = 1 To n - 1
                combination(k) = subcombination(k - 1)
            Next k
            
            combinations(j) = combination
        Next j
        
        GetCombinations = combinations
    End If
End Function
