Imports System
Imports System.Collections.Generic
Imports System.Linq

Module Module1
    Sub Main()
        Dim myList As New List(Of String) From {"s", "a", "l", "y", "h", "e"}
        Dim combinations = GetCombinations(myList)

        For Each combination In combinations
            Console.WriteLine(String.Join(",", combination))
        Next
    End Sub

    Function GetCombinations(Of T)(ByVal list As List(Of T)) As List(Of List(Of T))
        If list.Count = 0 Then
            Return New List(Of List(Of T)) From {New List(Of T)}
        End If

        Dim head = list(0)
        Dim tail = list.Skip(1).ToList()
        Dim tailCombinations = GetCombinations(tail)

        Dim result As New List(Of List(Of T))
        result.AddRange(tailCombinations)
        For Each tailCombination In tailCombinations
            For i As Integer = 0 To tailCombination.Count
                Dim combination As New List(Of T)(tailCombination)
                combination.Insert(i, head)
                result.Add(combination)
            Next
        Next

        Return result
    End Function
End Module
